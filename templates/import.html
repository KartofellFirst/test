<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
	<style>
		.dropdown-results {
			margin-top: 10px;
			border: 1px solid #ccc;
			max-height: 200px;
			overflow-y: auto;
			padding: 5px;
		}
		
		.dropdown-item {
			padding: 8px;
			cursor: pointer;
			border-bottom: 1px solid #eee;
		}
		
		.dropdown-item:hover {
			background-color: #f0f0f0;
		}
	</style>
</head>
<body>
    <!-- import.html -->
	<div class="modal-content">
		<h2>–ò–º–ø–æ—Ä—Ç —Ç—Ä–µ–∫–∞</h2>
		
		<!-- üîä –§–æ—Ä–º–∞ Spotify -->
		<form id="spotify-form" onsubmit="event.preventDefault(); searchSpotify();">
			<h3>üîç –ù–∞–π—Ç–∏ —Ç—Ä–µ–∫ —á–µ—Ä–µ–∑ Spotify</h3>
			
			<!-- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é -->
			<label for="spotify-title">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç—Ä–µ–∫–∞</label>
			<input type="text" id="spotify-title" name="spotify-title" autocomplete="off" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ...">
			
			<!-- Dropdown —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ -->
			<div id="spotify-dropdown" class="dropdown-results"></div>
			
			<!-- –í–≤–æ–¥ URL -->
			<label for="spotify-url">Spotify URL (–µ—Å–ª–∏ –µ—Å—Ç—å)</label>
			<input type="text" id="spotify-url" name="spotify-url" placeholder="https://open.spotify.com/track/...">
			<button type="button" onclick="fetchSpotifyData()">üîé –ò—Å–∫–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</button>
		</form>
		
		<!-- üîó –í—Ç–æ—Ä–∞—è —Ñ–æ—Ä–º–∞ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–∑–∂–µ -->
		<!-- <form id="external-form">...</form> -->
	</div>
	
	<script>
	// üëÅÔ∏è –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–æ–±–Ω–æ–≤–ª—è–µ–º dropdown)
	async function searchSpotify() {
	const query = document.getElementById("spotify-title").value;
	const res = await fetch(`/search/title?q=${encodeURIComponent(query)}`);
	const data = await res.json();
	
	const dropdown = document.getElementById("spotify-dropdown");
	dropdown.innerHTML = "";
	data.forEach(track => {
	  const el = document.createElement("div");
	  el.className = "dropdown-item";
	  el.innerHTML = `
		<strong>${track.title}</strong> ‚Äî ${track.author}
		<br><small>–ñ–∞–Ω—Ä—ã: ${track.genres}</small>
	  `;
	  el.onclick = () => selectTrack(track);
	  dropdown.appendChild(el);
	});
	}
	
	// üéØ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä—Å–∏–Ω–≥ –ø–æ URL
	async function fetchSpotifyData() {
	const url = document.getElementById("spotify-url").value;
	// –¢—É—Ç –≤—ã–∑–æ–≤ –∫ /analyze-by-url –∏–ª–∏ /extract-data?url=... (–Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å)
	alert("–ê–≤—Ç–æ–ø–æ–∏—Å–∫ –ø–æ URL: –ø–æ–∫–∞ —Ñ–µ–π–∫–æ–≤—ã–π");
	}
	
	function selectTrack(track) {
	console.log("–í—ã–±—Ä–∞–Ω —Ç—Ä–µ–∫:", track);
	// –ú–æ–∂–µ—à—å –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ, –º–æ–¥–µ—Ä–∞—Ü–∏—é –∏ –ø—Ä–æ—á–µ–µ
	}
	</script>
</body>
</html>
